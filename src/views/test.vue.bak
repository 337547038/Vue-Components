<!-- Created by 337547038 on 2021/5/17 0017. -->
<template>
  <div>
    <children ref="childel" text="1" @click="childClick" />
    <hr>
    <p>reactive:{{ reactive1 }}</p>
    <p>reactiveObj:{{ reactiveObj.name }}</p>
    <p>{{ ref1 }}</p>
    <p @click="updateLocation">click</p>
    <p>computed:{{ txt }}</p>
  </div>
</template>

<script lang="ts">
import {provide, reactive, ref, defineComponent, toRefs, computed, nextTick, getCurrentInstance} from 'vue'
import buttona from '../../packages/button/index.vue'
import children from './components/child.vue'
import {useRoute, useRouter} from 'vue-router'

export default defineComponent({
  components: {
    children
  },
  setup(props, {attrs, slots, emit}) {
    // 获取路由
    /*const {ctx} = getCurrentInstance()
    console.log(ctx)
    console.log(ctx.$router.currentRoute.value)*/
    const $route = useRoute()
    const $router = useRouter()
    /*console.log($router)
    console.log($route.path)
    console.log(toRefs($route))*/
    // console.log($router)

    let reactive1 = reactive('fsfs')
    let reactiveObj = reactive({
      name: '11',
      value: '1111122'
    })
    const ref1 = ref('reactiveafsf')
    provide('location', reactive1)
    provide('geolocation', ref1)

    /*function updateLocation() {
        console.log('2222')
    }*/
    const root = ref(null)
    const childel = ref(null)
    const updateLocation = () => {
      console.log('11111')
      ref1.value = 'South Pole'
      reactive1 = '2121312131'
      reactiveObj.name = 'name'
      // this.$refs.xxx.init()
      childel.value.init()
    }
    /*onMethods(() => {
      // DOM元素将在初始渲染后分配给ref
      console.log('') // <div>这是根元素</div>
    })*/

    const childClick = () => {
      console.log('childClick ok')
    }
    const txt = computed(() => {
      return 'aa'
    })
    // nextTick
    nextTick(() => {
      console.log('await nextTick()')
    })
    return {
      reactive1,
      ref1,
      updateLocation,
      reactiveObj,
      childClick,
      txt,
      root,
      childel
    }

  }
  /*methods: {
      updateLocation1() {
          console.log('update')
          this.reactive1 = 'South Pole0'
          this.ref1 = '2131321'
      }
  }*/
})
</script>
